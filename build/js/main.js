Array.prototype.shuffle=function(){var e=this.length,t,n,r;if(e===0)return!1;while(--e)t=Math.floor(Math.random()*(e+1)),n=this[e],r=this[t],this[e]=r,this[t]=n;return this},define("tools",function(){}),define("card",["exports"],function(e){function t(){this.ID=null,this.suit=null,this.val=null,this.first=!1,this.last=!1,this.init=function(e,t,n,r,i){this.ID=e,this.suit=t,this.val=n,this.first=r||!1,this.last=i||!1},this.getId=function(){return this.ID},this.getSuit=function(){return this.suit},this.getValue=function(){return this.val},this.getFirst=function(){return this.first},this.getLast=function(){return this.last},this.getFace=function(){switch(this.val){case 11:return"Jack";case 12:return"Queen";case 13:return"King";case 14:return"Ace";default:return this.val}}}e.card=t}),define("player",["card","exports"],function(e,t){function n(){this.ID=null,this.Name=null,this.money=null,this.cards=[],this.ranks=[],this.currenttable=null,this.playing=!1,this.init=function(e,t,n){this.ID=e,this.Name=t,this.money=n,this.playing=!0},this.getId=function(){return this.ID},this.getName=function(){return this.Name},this.getMoney=function(){return this.money},this.joinTable=function(e){this.currenttable=e},this.receiveHand=function(e){this.flush(),this.cards=e,$("#"+this.currenttable.getName()+" .players #"+this.Name).append('<div class="cards"></div>');var t=$("#"+this.currenttable.getName()+" .players #"+this.Name+" .cards");for(var n=0;n<this.cards.length;n++){var r=this.cards[n].getSuit(),i=this.cards[n].getFace();t.append('<span class="card '+r.toLowerCase()+'">'+i+" of "+r+"</span>")}},this.showHand=function(){return this.cards},this.flush=function(){this.cards=[]},this.addMoney=function(e){this.money+=e},this.removeMoney=function(e){this.money-=e},this.addRank=function(e,t){this.ranks.push({rank:t})},this.placeBet=function(e){this.currenttable.addToPot(e),this.removeMoney(e)},this.fold=function(){this.playing=!1},this.leaveTable=function(){this.fold(),this.currentTable!==null&&this.currentTable.removePlayer(this),this.currentTable=null},this.leaveGame=function(){this.leaveTable(),this.cards=null,this.ranks=null}}t.player=n}),define("deck",["card","exports"],function(e,t){function n(){this.suits=[],this.cards=[],this.usedcards=[],this.init=function(){this.suits=["Hearts","Diamonds","Clubs","Spades"],this.fillDeck(),this.shuffleDeck()},this.fillDeck=function(){for(var t=0;t<this.suits.length;t++)for(var n=2;n<=14;n++){var r=new e.card;n===2?this.addCard(this.suits[t],n,!0,!1):n===14?this.addCard(this.suits[t],n,!1,!0):this.addCard(this.suits[t],n,!1,!1)}},this.addCard=function(t,n,r,i){var s=new e.card;s.init(this.cards.length,t,n,r,i),this.cards.push(s)},this.getCards=function(){return this.cards},this.cutDeck=function(){var e=this.cards.length/2,t=this.cards.length-e,n=this.cards.splice(e,t),r=n.concat(this.cards);this.cards=r},this.shuffleDeck=function(){this.cards.shuffle()},this.getTopCard=function(){var e=this.cards.shift();return this.usedcards.push(e),e},this.putAway=function(){this.cards.clear(),this.usedcards.clear()}}t.deck=n}),define("dealer.logic",["table","deck","exports"],function(e,t,n){function r(){this.dealCards=function(e,t){var n=[];for(var r=0;r<t;r++)n.push(e.getTopCard());return n},this.score=function(e){var t=null,n=null,r=e.findPlayersStillPlaying(),i=e.getOpenCards();for(var s=0;s<r.length;s++){var o=r[s],u=i.concat(o.showHand()).sort(this.cardComperator),a=null,f=null,l=null,c=2,h=0,p=!1,d=!1,v=!1;for(var m=0;m<u.length;m++){l=this.findFlush(u),l===9?h<9&&(h=9):l===8?h<8&&(h=8):l===5?h<5&&(h=5):l===4&&h<4&&(h=4);if(h<8&&u[m].getValue()!==f){f=u[m].getValue();var g=this.findOccurences(u[m],u);g>3?h<7&&(h=7):g>2?(v===!0?h<6&&(h=6):d===!0?h<6&&(h=6):p===!0&&h<6&&(h=6),v=!0,h<3&&(h=3)):g>1&&(v===!0?h<6&&(h=6):p===!0&&(h<2&&(h=2),d=!0),h<1&&(h=1),p=!0)}}c=this.findHighestCard(u);var y=$("#"+e.getName()+" .players #"+o.getName());h===9?y.append("<span>Royal Flush with the "+c.getFace()+" of "+c.getSuit()+" </span>"):h===8?y.append("<span>Royal Flush with the "+c.getFace()+" of "+c.getSuit()+" </span>"):h===7?y.append("<span>Four of a kind with the "+c.getFace()+" of "+c.getSuit()+" </span>"):h===6?y.append("<span>Fullhouse with the "+c.getFace()+" of "+c.getSuit()+" </span>"):h===5?y.append("<span>Flush with the "+c.getFace()+" of "+c.getSuit()+" </span>"):h===4?y.append("<span>Straight with the "+c.getFace()+" of "+c.getSuit()+" </span>"):h===3?y.append("<span>Three of a kind with the "+c.getFace()+" of "+c.getSuit()+" </span>"):h===2?y.append("<span>Two pair with the "+c.getFace()+" of "+c.getSuit()+" </span>"):h===1?y.append("<span>Pair with the "+c.getFace()+" of "+c.getSuit()+" </span>"):y.append("<span>"+c.getFace()+" of "+c.getSuit()+" </span>")}},this.cardComperator=function(e,t){return parseInt(e.getValue(),10)-parseInt(t.getValue(),10)},this.hasStraight=function(e){var t=e.slice(0,5),n=!0,r=null;for(var i=0;i<t.length;i++)r===null?r=t[i].getValue():r+1!==t[i]&&(n=!1);if(n===!0)return!0;n=!0,r=null;var s=e.slice(1,6);for(var o=0;o<s.length;o++)r===null?r=s[o].getValue():r+1!==s[o]&&(n=!1);if(n===!0)return!0;var u=e.slice(2,7);n=!0,r=null;for(var a=0;a<u.length;a++)r===null?r=u[a].getValue():r+1!==u[a]&&(n=!1);return n===!0?!0:!1},this.findFlush=function(e){var t=[[],[],[],[]],n=this.hasStraight(e);for(var r=0;r<e.length;r++){var i=e[r].getSuit();i==="Hearts"?t[0].push(e[r]):i==="Diamonds"?t[1].push(e[r]):i==="Clubs"?t[2].push(e[r]):i==="Spades"&&t[3].push(e[r])}for(var s=0;s<t.length;s++)if(t[s].length===5){var o=!0,u=null;for(var a=0;a<t[s].length;a++)u===null?u=t[s][a].getValue():u+1!==t[s][a].getValue()&&(o=!1);if(o===!0&&t[s][0].getValue()===10)return 9;if(o===!0)return 9;if(o!==!0)return 5;if(n===!0)return 4}},this.findOccurences=function(e,t){var n=0;for(var r=0;r<t.length;r++)e.getValue()===t[r].getValue()&&n++;return n},this.findHighestCard=function(e){var t=null;for(var n=0;n<e.length;n++){var r=e[n];t===null?t=r:r.getValue()>t.getValue()&&(t=r)}return t}}n.logic=r}),define("dealer",["table","player","deck","dealer.logic","card","exports"],function(e,t,n,r,i,s){function o(){this.ID=null,this.table=null,this.deck=null,this.active=!1,this.logic=null,this.init=function(e,t){this.ID=e,this.table=t,this.deck=new n.deck,this.deck.init(),this.logic=new r.logic,this.deal()},this.getId=function(){return this.ID},this.getDeck=function(){return this.deck},this.getTable=function(){return this.table},this.getActive=function(){return this.active},this.deal=function(){if(this.active===!0){this.deck.cutDeck();var e=this.table.findPlayersStillPlaying();for(var t=0;t<e.length;t++){var n=this.logic.dealCards(this.deck,2),r=e[t];r.receiveHand(n)}var i=$("#"+this.table.getName()+" .dealer .status");i.append("<div class=event><span>Burn a card!</span></div>"),this.burnCard(),i.append("<div class=event><span>Flop!</span></div>"),this.addOpenCards(3),i.append("<div class=event><span>Burn a card!</span></div>"),this.burnCard(),i.append("<div class=event><span>Turn!</span></div>"),this.addOpenCards(1),i.append("<div class=event><span>Burn a card!</span></div>"),this.burnCard(),i.append("<div class=event><span>River!</span></div>"),this.addOpenCards(1),this.active=!1,this.logic.score(this.table)}},this.burnCard=function(){this.logic.dealCards(this.deck,1)},this.addOpenCards=function(e){var t=this.logic.dealCards(this.deck,e);this.table.addOpenCards(t)},this.pause=function(){this.active=!1},this.resume=function(){this.active=!0,this.deal()},this.goHome=function(){this.deck.putAway()}}s.dealer=o}),define("table",["player","dealer","exports"],function(e,t,n){function r(){this.ID=null,this.Name=null,this.minbet=null,this.maxbet=null,this.tablepot=null,this.sidepot=null,this.players=[],this.opencards=[],this.init=function(e,n,r,i){this.ID=e,this.Name=n,this.minbet=r,this.maxbet=i,this.dealer=new t.dealer,this.dealer.init(e,this)},this.getId=function(){return this.ID},this.getName=function(){return this.Name},this.getMinBet=function(){return this.minbet},this.getMaxBet=function(){return this.maxbet},this.getTablePot=function(){return this.tablepot},this.getSidePot=function(){return this.sidepot},this.getOpenCards=function(){return this.opencards},this.addOpenCards=function(e){for(var t=0;t<e.length;t++){var n=$("#"+this.Name+" .dealer .status"),r=e[t].getSuit(),i=e[t].getFace();n.append('<div class="card '+r.toLowerCase()+'"><span>'+i+" of "+r+"</span></div>")}var s=this.opencards.concat(e);this.opencards=s},this.addToPot=function(e){var t=this.findPlayersStillPlaying(),n=this.findLowestPurse();e<=n?this.addToTablePot(e):(this.addToTablePot(n),this.addtoSidePot(e-n))},this.addToTablePot=function(e){this.tablepot+=e},this.addtoSidePot=function(e){this.sidepot+=e},this.addPlayer=function(e){this.players.push(e);var t=$("#"+this.getName()+".status");t.append("<span>"+e.getName()+" joined!</span>"),this.players.length>1?this.dealer.getDeck().getCards().length===0?(t.append("<span>enough players dealer initiated!</span>"),this.dealer.init()):(t.append("<span>enough players dealer re-activated!</span>"),this.dealer.resume()):(t.append("<span>not enough players dealer paused!</span>"),this.dealer.pause())},this.removePlayer=function(e){var t=$("#"+this.getName()+".status");t.append("<span>"+e.getName()+" left!</span>"),this.players.pop(e),this.checkIfTableIsEmpty()&&(t.append("<span>table is empty!</span>"),this.removeTable())},this.findPlayersStillPlaying=function(){var e=[];for(var t=0;t<this.players.length;t++)this.players[t].playing&&e.push(this.players[t]);return e},this.findLowestPurse=function(e,t){var n=null;for(var r=0;r<e.length;r++)n!==null&&n>e[r].getMoney()?n=t:n===null&&(n=t);return n},this.checkIfTableIsEmpty=function(){return this.players.length===0?!0:!1},this.closeTable=function(){for(var e=0;e<this.players.length;e++)this.removePlayer(players[e]);this.dealer.goHome(),this.dealer=null}}n.table=r}),define("game",["player","table","exports"],function(e,t,n){function r(){this.players=[],this.tables=[],this.running=!1,this.init=function(){this.running=!0},this.gameTest=function(){var t=new e.player;t.init(this.players.length,"Admin",0),this.addPlayer(t),this.addTable("Rookie_Room",1,100),this.addTable("Pro_Corner",100,1e3);var n=new e.player;n.init(this.players.length,"Bob",1e3),this.addPlayer(n);var r=new e.player;r.init(this.players.length,"John",1e3),this.addPlayer(r);var i=new e.player;i.init(this.players.length,"Tom",1e3),this.addPlayer(i),this.joinTable(this.tables[0],n),this.joinTable(this.tables[1],r),this.joinTable(this.tables[0],i)},this.addTable=function(e,n,r){if(this.running){e=e||"Table"+this.getTableCount(),n=n||1,r=r||100;var i=this.tables.length,s=new t.table;s.init(i,e,n,r),this.tables.push(s),$("#tables").append("<div class=room id="+s.getName()+"><div class=roomname>"+s.getName()+"</div>"),$("#"+s.getName()).append("<div class=dealer><div class=dealername>Dealer</div></div>");var o=$("#"+s.getName()+" .dealer");o.append("<div class=status></div>"),$("#"+s.getName()).append("<div class=players></div>")}},this.getTableCount=function(){return this.tables.length},this.getTables=function(){return this.tables},this.showTable=function(e){},this.addPlayer=function(e){this.running&&(this.players.push(e),$("#players").append('<div class="player" id="'+e.getName()+'"><span>'+e.getName()+"</span></div>"))},this.removePlayer=function(e){this.players.pop(e),this.players.length===0&&this.stopGame()},this.getPlayers=function(){var e=[];for(var t=0;t<this.tables.length;t++){var n=[];e=e.concat(this.tables[t].findPlayersStillPlaying())}return e},this.joinTable=function(e,t){t.joinTable(e),$("#"+e.getName()+" .players").append('<div class="player" id="'+t.getName()+'"></div>'),$("#"+e.getName()+" .players #"+t.getName()).append("<div class=playername><span>"+t.getName()+"</span></div>"),e.addPlayer(t)},this.stopGame=function(){for(var e=0;e<this.tables.length;e++)this.tables[e].closeTable();this.running=!1}}n.game=r}),requirejs(["tools","game"],function(e,t){var n=new t.game;n.init(),n.gameTest()}),define("main",function(){})